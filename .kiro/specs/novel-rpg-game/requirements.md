# Requirements Document

## Introduction

The Novel RPG Game is an interactive storytelling application that transforms any novel into a role-playing game experience. The system supports 1-4 human players with AI-controlled computer players filling remaining slots, and uses an LLM as the master storyteller to guide gameplay through multiple possible endings based on player choices.

## Glossary

- **Game_Master**: The LLM system that analyzes novels and guides storytelling
- **Game_State_File**: Local storage file containing game progress and metadata
- **Player_Action**: A choice made by rolling dice (talk, act, or do nothing)
- **Story_Segment**: Generated narrative content (dialogue or action description)
- **Ending_Variant**: One of 8 possible story conclusions generated by the Game_Master
- **Computer_Player**: AI-controlled player that fills empty player slots
- **Human_Player**: User-controlled player participating in the game
- **Novel_Analysis**: LLM processing of input novel to extract key story elements

## Requirements

### Requirement 1: Game Setup and Input Validation

**User Story:** As a user, I want to start a new game by providing a novel file and game parameters, so that I can begin an interactive storytelling experience.

#### Acceptance Criteria

1. WHEN a user provides a novel text file, number of human players (1-4), and rounds (10-20), THE System SHALL validate all parameters including file size limits before proceeding
2. WHEN a novel file exceeds 50MB in size, THE System SHALL reject the file with a clear size limit error message
3. WHEN invalid parameters are provided, THE System SHALL display informative error messages and terminate gracefully
4. WHEN valid parameters are provided, THE System SHALL proceed to novel analysis
5. THE System SHALL support common text file formats for novel input
6. WHEN the number of human players is less than 4, THE System SHALL automatically assign computer players to reach exactly 4 total players

### Requirement 2: Novel Analysis and Game State Creation

**User Story:** As a game master, I want the system to analyze the novel and extract key story elements, so that the game can be structured around the original narrative.

#### Acceptance Criteria

1. WHEN a novel is provided, THE Game_Master SHALL identify the top 4 main characters from the text
2. WHEN analyzing the novel, THE Game_Master SHALL extract 5 high-level plot points, the introduction, climax, and conclusion
3. THE Game_Master SHALL NOT use any internet resources during analysis
4. WHEN analysis is complete, THE System SHALL validate that all required elements were successfully extracted
5. WHEN novel analysis fails to produce required elements, THE System SHALL terminate the game early with an informative error message
6. WHEN analysis is complete and valid, THE System SHALL save results to a Game_State_File named "DateTime-numberOfPlayers-novelTitle-rounds.txt"
7. THE Game_State_File SHALL contain all extracted story elements for use throughout the game

### Requirement 3: Character Selection Process

**User Story:** As a player, I want to select my character through a fair dice-rolling system, so that character assignment is random and engaging.

#### Acceptance Criteria

1. WHEN character selection begins, THE System SHALL prompt each human player to roll dice by pressing the space bar
2. WHEN a player presses the space bar, THE System SHALL generate a random number between 1 and 10
3. WHEN all players have rolled, THE System SHALL determine player order based on highest roll (Player 1 = highest)
4. WHEN it's a player's turn, THE System SHALL display the 4 main characters and prompt for selection
5. WHEN a character is selected, THE System SHALL remove it from available options for subsequent players
6. WHEN all human players have selected characters, THE System SHALL assign remaining characters to computer players

### Requirement 4: Story Ending Generation

**User Story:** As a game master, I want multiple possible story endings generated, so that player choices can lead to different narrative conclusions.

#### Acceptance Criteria

1. WHEN character selection is complete, THE Game_Master SHALL generate exactly 8 different story endings
2. WHEN ending generation fails to produce 8 valid endings, THE System SHALL terminate the game early with an informative error message
3. THE Game_Master SHALL create 1 ending that matches the original novel's conclusion
4. THE Game_Master SHALL create 3 endings that are 80% similar to the original ending
5. THE Game_Master SHALL create 1 ending that is the direct opposite of the original ending
6. THE Game_Master SHALL create 3 completely random alternative endings
7. THE System SHALL store all 8 endings for use during gameplay

### Requirement 5: Player Turn Mechanics

**User Story:** As a player, I want to make choices through dice rolling that affect the story, so that I can influence the narrative direction.

#### Acceptance Criteria

1. WHEN it's a player's turn, THE System SHALL prompt them to press the space bar within 1 minute
2. WHEN the space bar is pressed or time expires, THE System SHALL generate a random number between 1 and 10
3. WHEN an even number (2,4,6,8,10) is generated, THE System SHALL record that the player chose to "talk"
4. WHEN 1, 3, or 5 is generated, THE System SHALL record that the player chose to "act"
5. WHEN 7 or 9 is generated, THE System SHALL record that the player chose to "do nothing"
6. THE System SHALL display the chosen action on screen and save it to the Game_State_File

### Requirement 6: Story Generation and Progression

**User Story:** As a game master, I want to generate appropriate narrative content based on player actions, so that the story progresses toward one of the possible endings.

#### Acceptance Criteria

1. WHEN a player chooses to "talk", THE Game_Master SHALL generate approximately 200 words of dialogue between characters
2. WHEN a player chooses to "act", THE Game_Master SHALL generate approximately 100 words of narrative action
3. WHEN a player chooses to "do nothing", THE System SHALL add one additional round to the total game rounds
4. WHEN generating content, THE Game_Master SHALL move the story closer to one of the 8 possible endings
5. THE System SHALL write all generated content to the Game_State_File and display it on screen
6. WHEN "do nothing" is chosen, THE System SHALL display the updated round count on screen and in the Game_State_File

### Requirement 7: Automated Testing Framework

**User Story:** As a developer, I want an automated testing system that evaluates story cohesion across different game configurations, so that I can assess the quality of generated narratives.

#### Acceptance Criteria

1. WHEN testing mode is activated, THE System SHALL generate games with all computer players
2. WHEN running tests, THE System SHALL create games for round counts from 10 to 20, incrementing by 2
3. WHEN each test game completes, THE System SHALL save the complete story to an output file
4. WHEN all test games are complete, THE Game_Master SHALL analyze all output files for story cohesion
5. THE System SHALL generate a report table with columns: rounds played, ending achieved, and cohesion rank (1-10)
6. THE System SHALL sort the report by most cohesive stories first, least cohesive last

### Requirement 8: Game State Persistence

**User Story:** As a system administrator, I want all game data properly saved and retrievable, so that game sessions can be tracked and analyzed.

#### Acceptance Criteria

1. WHEN a game begins, THE System SHALL create a uniquely named Game_State_File
2. WHEN game events occur, THE System SHALL append relevant data to the Game_State_File immediately
3. THE Game_State_File SHALL contain novel analysis, player selections, actions, and generated story content
4. WHEN the game ends, THE Game_State_File SHALL contain the complete game session record
5. THE System SHALL ensure Game_State_File integrity throughout the entire game session